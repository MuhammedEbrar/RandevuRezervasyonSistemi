# Randevu ve Kiralama Platformu - Mobil API Dok√ºmantasyonu

## üìã Genel Bilgiler

### API Base URL
- **Production:** `http://13.60.31.19/api/v1`
- **API Docs:** `http://13.60.31.19/docs`

### Authentication
- **Tip:** JWT (JSON Web Token)
- **Header:** `Authorization: Bearer {token}`
- **Token Expire:** 30 dakika

---

## üîê Authentication Endpoints

### 1. Kullanƒ±cƒ± Kaydƒ± (Register)

**Endpoint:** `POST /auth/register`

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "minimum8karakter",
  "role": "CUSTOMER",  // veya "BUSINESS_OWNER"
  "first_name": "Ahmet",
  "last_name": "Yƒ±lmaz",
  "phone_number": "5551234567"  // Opsiyonel
}
```

**Validasyon Kurallarƒ±:**
- `email`: Ge√ßerli email formatƒ±
- `password`: Minimum 8 karakter
- `role`: Sadece "CUSTOMER" veya "BUSINESS_OWNER"
- `first_name`, `last_name`: Opsiyonel
- `phone_number`: Opsiyonel

**Success Response (201 Created):**
```json
{
  "user_id": "123e4567-e89b-12d3-a456-426614174000",
  "email": "user@example.com",
  "role": "CUSTOMER",
  "first_name": "Ahmet",
  "last_name": "Yƒ±lmaz",
  "phone_number": "5551234567",
  "profile_picture_url": null,
  "is_active": true,
  "created_at": "2025-10-23T10:30:00",
  "updated_at": null
}
```

**Error Response (422 Validation Error):**
```json
{
  "detail": [
    {
      "type": "string_too_short",
      "loc": ["body", "password"],
      "msg": "String should have at least 8 characters",
      "input": "123",
      "ctx": {"min_length": 8}
    }
  ]
}
```

---

### 2. Kullanƒ±cƒ± Giri≈üi (Login)

**Endpoint:** `POST /auth/login`

**Request Headers:**
```
Content-Type: application/x-www-form-urlencoded
```

**Request Body (Form Data):**
```
username=user@example.com
password=sifre123456
```

**Success Response (200 OK):**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
```

**Error Response (401 Unauthorized):**
```json
{
  "detail": "Email veya ≈üifre hatalƒ±."
}
```

---

## üë§ User Endpoints

### 3. Kullanƒ±cƒ± Profilini Getir

**Endpoint:** `GET /users/me`

**Headers:**
```
Authorization: Bearer {access_token}
```

**Success Response (200 OK):**
```json
{
  "user_id": "123e4567-e89b-12d3-a456-426614174000",
  "email": "user@example.com",
  "role": "CUSTOMER",
  "first_name": "Ahmet",
  "last_name": "Yƒ±lmaz",
  "phone_number": "5551234567",
  "profile_picture_url": null,
  "is_active": true,
  "created_at": "2025-10-23T10:30:00",
  "updated_at": "2025-10-23T11:00:00"
}
```

---

### 4. Kullanƒ±cƒ± Profilini G√ºncelle

**Endpoint:** `PUT /users/me`

**Headers:**
```
Authorization: Bearer {access_token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "first_name": "Mehmet",
  "last_name": "Demir",
  "phone_number": "5559876543",
  "profile_picture_url": "https://example.com/photo.jpg"
}
```

**Success Response (200 OK):**
```json
{
  "user_id": "123e4567-e89b-12d3-a456-426614174000",
  "email": "user@example.com",
  "role": "CUSTOMER",
  "first_name": "Mehmet",
  "last_name": "Demir",
  "phone_number": "5559876543",
  "profile_picture_url": "https://example.com/photo.jpg",
  "is_active": true,
  "created_at": "2025-10-23T10:30:00",
  "updated_at": "2025-10-23T12:00:00"
}
```

---

## üè¢ Resource Endpoints (ƒ∞≈ü Yerleri / Kaynaklar)

### 5. T√ºm Kaynaklarƒ± Listele

**Endpoint:** `GET /resources/`

**Query Parameters:**
- `skip` (int, optional): Atlanacak kayƒ±t sayƒ±sƒ± (default: 0)
- `limit` (int, optional): Getirilecek kayƒ±t sayƒ±sƒ± (default: 100)
- `active_only` (bool, optional): Sadece aktif kaynaklar (default: true)

**Example:** `GET /resources/?skip=0&limit=10&active_only=true`

**Success Response (200 OK):**
```json
[
  {
    "resource_id": "123e4567-e89b-12d3-a456-426614174001",
    "owner_id": "123e4567-e89b-12d3-a456-426614174000",
    "resource_name": "Kuaf√∂r Salonu",
    "resource_type": "SINGLE_SLOT",
    "booking_type": "APPOINTMENT",
    "description": "Modern kuaf√∂r salonu",
    "location": "ƒ∞stanbul, Kadƒ±k√∂y",
    "capacity": 1,
    "is_active": true,
    "created_at": "2025-10-23T09:00:00"
  }
]
```

---

### 6. Kaynak Detayƒ±

**Endpoint:** `GET /resources/{resource_id}`

**Success Response (200 OK):**
```json
{
  "resource_id": "123e4567-e89b-12d3-a456-426614174001",
  "owner_id": "123e4567-e89b-12d3-a456-426614174000",
  "resource_name": "Kuaf√∂r Salonu",
  "resource_type": "SINGLE_SLOT",
  "booking_type": "APPOINTMENT",
  "description": "Modern kuaf√∂r salonu",
  "location": "ƒ∞stanbul, Kadƒ±k√∂y",
  "capacity": 1,
  "is_active": true,
  "created_at": "2025-10-23T09:00:00"
}
```

---

### 7. Yeni Kaynak Olu≈ütur (Sadece BUSINESS_OWNER)

**Endpoint:** `POST /resources/`

**Headers:**
```
Authorization: Bearer {access_token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "resource_name": "Spor Salonu",
  "resource_type": "MULTI_SLOT",
  "booking_type": "RENTAL",
  "description": "Modern fitness merkezi",
  "location": "Ankara, √áankaya",
  "capacity": 50
}
```

**Enum Values:**
- `resource_type`: "SINGLE_SLOT" | "MULTI_SLOT" | "UNLIMITED"
- `booking_type`: "APPOINTMENT" | "RENTAL"

**Success Response (201 Created):**
```json
{
  "resource_id": "123e4567-e89b-12d3-a456-426614174002",
  "owner_id": "123e4567-e89b-12d3-a456-426614174000",
  "resource_name": "Spor Salonu",
  "resource_type": "MULTI_SLOT",
  "booking_type": "RENTAL",
  "description": "Modern fitness merkezi",
  "location": "Ankara, √áankaya",
  "capacity": 50,
  "is_active": true,
  "created_at": "2025-10-23T14:00:00"
}
```

---

## üìÖ Availability Endpoints (M√ºsaitlik Takvimi)

### 8. Kaynak M√ºsaitlik Takvimini Getir

**Endpoint:** `GET /resources/{resource_id}/availability/`

**Success Response (200 OK):**
```json
[
  {
    "schedule_id": "123e4567-e89b-12d3-a456-426614174003",
    "resource_id": "123e4567-e89b-12d3-a456-426614174001",
    "schedule_type": "WEEKLY",
    "day_of_week": "MONDAY",
    "start_time": "09:00:00",
    "end_time": "18:00:00",
    "is_active": true
  }
]
```

**Enum Values:**
- `schedule_type`: "WEEKLY" | "ONE_TIME"
- `day_of_week`: "MONDAY" | "TUESDAY" | "WEDNESDAY" | "THURSDAY" | "FRIDAY" | "SATURDAY" | "SUNDAY"

---

### 9. M√ºsait Slot'larƒ± Getir

**Endpoint:** `GET /resources/{resource_id}/availability/available_slots`

**Query Parameters:**
- `start_date` (string, required): Ba≈ülangƒ±√ß tarihi (YYYY-MM-DD)
- `end_date` (string, required): Biti≈ü tarihi (YYYY-MM-DD)

**Example:** `GET /resources/{resource_id}/availability/available_slots?start_date=2025-10-25&end_date=2025-10-25`

**Success Response (200 OK):**
```json
[
  {
    "start_time": "2025-10-25T09:00:00",
    "end_time": "2025-10-25T10:00:00",
    "is_available": true
  },
  {
    "start_time": "2025-10-25T10:00:00",
    "end_time": "2025-10-25T11:00:00",
    "is_available": true
  },
  {
    "start_time": "2025-10-25T11:00:00",
    "end_time": "2025-10-25T12:00:00",
    "is_available": false
  }
]
```

---

## üìù Booking Endpoints (Rezervasyonlar)

### 10. Fiyat Hesaplama

**Endpoint:** `POST /bookings/calculate_price`

**Headers:**
```
Authorization: Bearer {access_token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "resource_id": "123e4567-e89b-12d3-a456-426614174001",
  "start_time": "2025-10-25T10:00:00",
  "end_time": "2025-10-25T11:00:00"
}
```

**Success Response (200 OK):**
```json
{
  "total_price": 150.00
}
```

---

### 11. Rezervasyon Olu≈ütur

**Endpoint:** `POST /bookings/`

**Headers:**
```
Authorization: Bearer {access_token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "resource_id": "123e4567-e89b-12d3-a456-426614174001",
  "start_time": "2025-10-25T10:00:00",
  "end_time": "2025-10-25T11:00:00",
  "notes": "Sa√ß kesimi istiyorum"
}
```

**Success Response (201 Created):**
```json
{
  "booking_id": "123e4567-e89b-12d3-a456-426614174004",
  "resource_id": "123e4567-e89b-12d3-a456-426614174001",
  "customer_id": "123e4567-e89b-12d3-a456-426614174000",
  "start_time": "2025-10-25T10:00:00",
  "end_time": "2025-10-25T11:00:00",
  "total_price": 150.00,
  "status": "PENDING",
  "notes": "Sa√ß kesimi istiyorum",
  "created_at": "2025-10-23T15:00:00"
}
```

**Booking Status Enum:**
- "PENDING": Bekliyor
- "CONFIRMED": Onaylandƒ±
- "CANCELLED": ƒ∞ptal edildi
- "COMPLETED": Tamamlandƒ±
- "NO_SHOW": Gelmedi

---

### 12. M√º≈üterinin Rezervasyonlarƒ±nƒ± Getir

**Endpoint:** `GET /bookings/customer`

**Headers:**
```
Authorization: Bearer {access_token}
```

**Success Response (200 OK):**
```json
[
  {
    "booking_id": "123e4567-e89b-12d3-a456-426614174004",
    "resource_id": "123e4567-e89b-12d3-a456-426614174001",
    "customer_id": "123e4567-e89b-12d3-a456-426614174000",
    "start_time": "2025-10-25T10:00:00",
    "end_time": "2025-10-25T11:00:00",
    "total_price": 150.00,
    "status": "CONFIRMED",
    "notes": "Sa√ß kesimi istiyorum",
    "created_at": "2025-10-23T15:00:00"
  }
]
```

---

## üí≥ Payment Endpoints (√ñdemeler)

### 13. √ñdeme Olu≈ütur

**Endpoint:** `POST /payments/`

**Headers:**
```
Authorization: Bearer {access_token}
Content-Type: application/json
```

**Request Body:**
```json
{
  "booking_id": "123e4567-e89b-12d3-a456-426614174004",
  "payment_method": "CREDIT_CARD",
  "amount": 150.00
}
```

**Payment Method Enum:**
- "CREDIT_CARD"
- "DEBIT_CARD"
- "CASH"
- "BANK_TRANSFER"

**Success Response (201 Created):**
```json
{
  "payment_id": "123e4567-e89b-12d3-a456-426614174005",
  "booking_id": "123e4567-e89b-12d3-a456-426614174004",
  "amount": 150.00,
  "payment_method": "CREDIT_CARD",
  "payment_status": "COMPLETED",
  "payment_date": "2025-10-23T15:30:00"
}
```

**Payment Status Enum:**
- "PENDING": Bekliyor
- "COMPLETED": Tamamlandƒ±
- "FAILED": Ba≈üarƒ±sƒ±z
- "REFUNDED": ƒ∞ade edildi

---

## üîß Genel Bilgiler

### Tarih-Saat Formatlarƒ±
- **ISO 8601:** `2025-10-25T10:00:00`
- **Tarih:** `2025-10-25`
- **Saat:** `09:00:00`

### UUID Formatƒ±
- **Format:** `123e4567-e89b-12d3-a456-426614174000`
- T√ºm ID'ler UUID v4 formatƒ±nda

### Pagination
- `skip`: Ka√ß kayƒ±t atlanacak (default: 0)
- `limit`: Ka√ß kayƒ±t getirilecek (default: 100)

### Error Codes
- `200`: OK - Ba≈üarƒ±lƒ±
- `201`: Created - Kayƒ±t olu≈üturuldu
- `400`: Bad Request - Hatalƒ± istek
- `401`: Unauthorized - Yetkisiz eri≈üim
- `403`: Forbidden - Eri≈üim yasak
- `404`: Not Found - Bulunamadƒ±
- `422`: Validation Error - Doƒürulama hatasƒ±
- `500`: Internal Server Error - Sunucu hatasƒ±

---

## üß™ Test Kullanƒ±cƒ±larƒ±

### Test i√ßin Database Credentials (Geli≈ütirme Ama√ßlƒ±)
```
Database Host: 13.60.31.19:5432
Database Name: randevuplatformu_db
Username: randevuuser
Password: RandevuDB2025SecurePass
```

**NOT:** Production i√ßin bu bilgileri kullanmayƒ±n!

---

## üì± Mobil Uygulama ƒ∞√ßin √ñneriler

### 1. Token Y√∂netimi
- Token'ƒ± g√ºvenli ≈üekilde saklayƒ±n (Keychain/Keystore)
- Her istekte `Authorization: Bearer {token}` header'ƒ± ekleyin
- Token expire olduƒüunda kullanƒ±cƒ±yƒ± yeniden login'e y√∂nlendirin

### 2. Error Handling
- 401 hatasƒ± ‚Üí Kullanƒ±cƒ±yƒ± login sayfasƒ±na y√∂nlendirin
- 422 hatasƒ± ‚Üí Validation error mesajlarƒ±nƒ± kullanƒ±cƒ±ya g√∂sterin
- 500 hatasƒ± ‚Üí "Sunucu hatasƒ±, l√ºtfen daha sonra tekrar deneyin" mesajƒ± g√∂sterin

### 3. Offline Desteƒüi
- Kritik verileri local cache'leyin
- Network olmadƒ±ƒüƒ±nda cached data g√∂sterin
- Online olunca sync yapƒ±n

### 4. Performans
- Image'leri cache'leyin
- List view'lerde pagination kullanƒ±n
- Gereksiz API call'lardan ka√ßƒ±nƒ±n

### 5. UI/UX
- Loading indicator'larƒ± g√∂sterin
- Hata mesajlarƒ±nƒ± kullanƒ±cƒ± dostu g√∂sterin
- Success/error feedback'leri verin

---

## üîó Faydalƒ± Linkler

- **API Interactive Docs:** http://13.60.31.19/docs
- **Frontend Demo:** http://13.60.31.19/

---

## üìû ƒ∞leti≈üim

Sorularƒ±nƒ±z i√ßin:
- Backend Developer: [ƒ∞leti≈üim Bilgisi]
- API Issues: GitHub Issues

---

**Son G√ºncelleme:** 2025-10-23
**API Version:** 1.0.0
